<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}SpendSmart{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/minimal.css') }}?v=4.0"
    />
    {% block head %}{% endblock %}
  </head>
  <body class="page">
    <!-- Minimal Navigation -->
    <nav class="navbar">
      <div class="navbar-container">
        <a
          class="navbar-brand"
          href="{{ url_for('main.dashboard') if current_user.is_authenticated else url_for('main.login') }}"
        >
          SpendSmart
        </a>

        {% if current_user.is_authenticated %}
        <ul class="navbar-nav">
          <li>
            <a class="nav-link active" href="{{ url_for('main.dashboard') }}">
              Dashboard
            </a>
          </li>
          <li>
            <a class="nav-link" href="{{ url_for('main.receipt_page') }}">
              Receipts
            </a>
          </li>
          <li class="dropdown">
            <button class="nav-link dropdown-toggle" id="profileDropdown">
              {{ current_user.username }}
            </button>
            <div class="dropdown-menu" id="profileMenu">
              <a class="dropdown-item" href="{{ url_for('main.profile') }}"
                >Profile</a
              >
              <a class="dropdown-item" href="{{ url_for('main.logout') }}"
                >Logout</a
              >
            </div>
          </li>
        </ul>
        {% else %}
        <ul class="navbar-nav">
          <li>
            <a class="nav-link" href="{{ url_for('main.login') }}"> Login </a>
          </li>
          <li>
            <a class="btn btn-primary" href="{{ url_for('main.register') }}">
              Get Started
            </a>
          </li>
        </ul>
        {% endif %}
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">{% block content %}{% endblock %}</div>
    </main>

    <!-- Dropdown Toggle Script -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const dropdown = document.getElementById("profileDropdown");
        const menu = document.getElementById("profileMenu");

        if (dropdown && menu) {
          // Toggle dropdown on click
          dropdown.addEventListener("click", function (e) {
            e.stopPropagation();
            menu.classList.toggle("show");
          });

          // Close dropdown when clicking outside
          document.addEventListener("click", function (e) {
            if (!dropdown.contains(e.target) && !menu.contains(e.target)) {
              menu.classList.remove("show");
            }
          });
        }
      });
    </script>

    {% block scripts %}{% endblock %}
  </body>
</html>
